<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">

<title>module TrackRecordSections::SectionsMixin - TrackRecord</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="module">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/track_record_sections.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    
    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-i-each_group">#each_group</a>
    
    <li><a href="#method-i-each_section">#each_section</a>
    
    <li><a href="#method-i-each_task">#each_task</a>
    
    <li><a href="#method-i-group">#group</a>
    
    <li><a href="#method-i-initialize_sections">#initialize_sections</a>
    
    <li><a href="#method-i-reassess_start_flags_using">#reassess_start_flags_using</a>
    
    <li><a href="#method-i-retrieve">#retrieve</a>
    
    <li><a href="#method-i-section">#section</a>
    
    <li><a href="#method-i-starts_new_group-3F">#starts_new_group?</a>
    
    <li><a href="#method-i-starts_new_section-3F">#starts_new_section?</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../CHANGELOG_rdoc.html">CHANGELOG</a>
  
    <li class="file"><a href="../README_rdoc.html">README</a>
  
    <li class="file"><a href="../doc/README_FOR_APP_rdoc.html">README_FOR_APP</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../TrackRecordReport.html">TrackRecordReport</a>
  
    <li><a href="../TrackRecordReport/Calculator.html">TrackRecordReport::Calculator</a>
  
    <li><a href="../TrackRecordReport/CalculatorWithUsers.html">TrackRecordReport::CalculatorWithUsers</a>
  
    <li><a href="../TrackRecordReport/Cell.html">TrackRecordReport::Cell</a>
  
    <li><a href="../TrackRecordReport/Report.html">TrackRecordReport::Report</a>
  
    <li><a href="../TrackRecordReport/Row.html">TrackRecordReport::Row</a>
  
    <li><a href="../TrackRecordReport/Section.html">TrackRecordReport::Section</a>
  
    <li><a href="../TrackRecordSections.html">TrackRecordSections</a>
  
    <li><a href="../TrackRecordSections/Group.html">TrackRecordSections::Group</a>
  
    <li><a href="../TrackRecordSections/GroupMixin.html">TrackRecordSections::GroupMixin</a>
  
    <li><a href="../TrackRecordSections/Section.html">TrackRecordSections::Section</a>
  
    <li><a href="../TrackRecordSections/SectionMixin.html">TrackRecordSections::SectionMixin</a>
  
    <li><a href="../TrackRecordSections/Sections.html">TrackRecordSections::Sections</a>
  
    <li><a href="../TrackRecordSections/SectionsMixin.html">TrackRecordSections::SectionsMixin</a>
  
    <li><a href="../ReportsHelper.html">ReportsHelper</a>
  
    <li><a href="../ReportsHelper/ReportMonth.html">ReportsHelper::ReportMonth</a>
  
    <li><a href="../ReportsHelper/ReportWeek.html">ReportsHelper::ReportWeek</a>
  
    <li><a href="../ReportsHelper/ReportYear.html">ReportsHelper::ReportYear</a>
  
    <li><a href="../QuietLeightbox.html">QuietLeightbox</a>
  
    <li><a href="../QuietLeightbox/ClassMethods.html">QuietLeightbox::ClassMethods</a>
  
    <li><a href="../QuietLeightbox/QuietLeightboxHelper.html">QuietLeightbox::QuietLeightboxHelper</a>
  
    <li><a href="../QuietPrototype.html">QuietPrototype</a>
  
    <li><a href="../QuietPrototype/ClassMethods.html">QuietPrototype::ClassMethods</a>
  
    <li><a href="../QuietPrototype/QuietPrototypeHelper.html">QuietPrototype::QuietPrototypeHelper</a>
  
    <li><a href="../YuiTree.html">YuiTree</a>
  
    <li><a href="../YuiTree/ClassMethods.html">YuiTree::ClassMethods</a>
  
    <li><a href="../YuiTree/YuiTreeHelper.html">YuiTree::YuiTreeHelper</a>
  
    <li><a href="../TrackRecordReportGenerator.html">TrackRecordReportGenerator</a>
  
    <li><a href="../TrackRecordReportGenerator/UkOrgPondCSV.html">TrackRecordReportGenerator::UkOrgPondCSV</a>
  
    <li><a href="../ApplicationController.html">ApplicationController</a>
  
    <li><a href="../ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="../AuditsController.html">AuditsController</a>
  
    <li><a href="../AuditsHelper.html">AuditsHelper</a>
  
    <li><a href="../ChartsController.html">ChartsController</a>
  
    <li><a href="../ChartsHelper.html">ChartsHelper</a>
  
    <li><a href="../ControlPanel.html">ControlPanel</a>
  
    <li><a href="../ControlPanelsController.html">ControlPanelsController</a>
  
    <li><a href="../Customer.html">Customer</a>
  
    <li><a href="../CustomersController.html">CustomersController</a>
  
    <li><a href="../CustomersHelper.html">CustomersHelper</a>
  
    <li><a href="../EmailNotifier.html">EmailNotifier</a>
  
    <li><a href="../HelpController.html">HelpController</a>
  
    <li><a href="../HelpHelper.html">HelpHelper</a>
  
    <li><a href="../Project.html">Project</a>
  
    <li><a href="../ProjectsController.html">ProjectsController</a>
  
    <li><a href="../ProjectsHelper.html">ProjectsHelper</a>
  
    <li><a href="../Rangeable.html">Rangeable</a>
  
    <li><a href="../ReportsController.html">ReportsController</a>
  
    <li><a href="../SavedReport.html">SavedReport</a>
  
    <li><a href="../SavedReportAutoTitlesController.html">SavedReportAutoTitlesController</a>
  
    <li><a href="../SavedReportsBaseController.html">SavedReportsBaseController</a>
  
    <li><a href="../SavedReportsByCustomerController.html">SavedReportsByCustomerController</a>
  
    <li><a href="../SavedReportsByProjectController.html">SavedReportsByProjectController</a>
  
    <li><a href="../SavedReportsByTaskController.html">SavedReportsByTaskController</a>
  
    <li><a href="../SavedReportsByUserController.html">SavedReportsByUserController</a>
  
    <li><a href="../SavedReportsController.html">SavedReportsController</a>
  
    <li><a href="../SavedReportsHelper.html">SavedReportsHelper</a>
  
    <li><a href="../SessionsController.html">SessionsController</a>
  
    <li><a href="../SignIn.html">SignIn</a>
  
    <li><a href="../Task.html">Task</a>
  
    <li><a href="../TaskGroup.html">TaskGroup</a>
  
    <li><a href="../TaskImport.html">TaskImport</a>
  
    <li><a href="../TaskImportsController.html">TaskImportsController</a>
  
    <li><a href="../TaskImportsHelper.html">TaskImportsHelper</a>
  
    <li><a href="../TasksController.html">TasksController</a>
  
    <li><a href="../TasksHelper.html">TasksHelper</a>
  
    <li><a href="../Timesheet.html">Timesheet</a>
  
    <li><a href="../TimesheetForceCommit.html">TimesheetForceCommit</a>
  
    <li><a href="../TimesheetForceCommitsController.html">TimesheetForceCommitsController</a>
  
    <li><a href="../TimesheetRow.html">TimesheetRow</a>
  
    <li><a href="../TimesheetRowsController.html">TimesheetRowsController</a>
  
    <li><a href="../TimesheetRowsHelper.html">TimesheetRowsHelper</a>
  
    <li><a href="../TimesheetsController.html">TimesheetsController</a>
  
    <li><a href="../TimesheetsHelper.html">TimesheetsHelper</a>
  
    <li><a href="../TreesController.html">TreesController</a>
  
    <li><a href="../User.html">User</a>
  
    <li><a href="../UsersController.html">UsersController</a>
  
    <li><a href="../UsersHelper.html">UsersHelper</a>
  
    <li><a href="../WorkPacket.html">WorkPacket</a>
  
    <li><a href="../WorkPacketsController.html">WorkPacketsController</a>
  
    <li><a href="../WorkPacketsHelper.html">WorkPacketsHelper</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="module">module TrackRecordSections::SectionsMixin</h1>

  <div id="description" class="description">
    
<p>All the guts of a <a href="Sections.html">Sections</a> class inside a
module, so multiple inheritance-like behaviour can be used for Reports
which expose the <a href="Sections.html">Sections</a> interface herein,
along with their own Calculator interface for overall totals.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-each_group" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_group</span><span
            class="method-args">() { |group| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>As “<a
href="SectionsMixin.html#method-i-each_section">#each_section</a>()”, but
for Groups.</p>
          

          
          <div class="method-source-code" id="each_group-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 290</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_group</span>
  <span class="ruby-ivar">@groups</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">group</span> <span class="ruby-operator">|</span>
    <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">group</span> )
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_group-source -->
          
        </div>

        

        
      </div><!-- each_group-method -->

    
      <div id="method-i-each_section" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_section</span><span
            class="method-args">() { |section| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Retrieve all <a href="Sections.html">Sections</a>, perhaps in order to
assign caller data. Call with a block, invoked with a <a
href="Section.html">Section</a> instance at each iteration. The returned <a
href="Section.html">Section</a> order is arbitrary. Use e.g. “iterate()”
for deterministic ordering.</p>
          

          
          <div class="method-source-code" id="each_section-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 282</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_section</span>
  <span class="ruby-ivar">@sections</span>.<span class="ruby-identifier">each_value</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">section</span> <span class="ruby-operator">|</span>
    <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">section</span> )
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_section-source -->
          
        </div>

        

        
      </div><!-- each_section-method -->

    
      <div id="method-i-each_task" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_task</span><span
            class="method-args">() { |task, section, is_new_section, group, is_new_group| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Iterate over the tasks provided in the constructor, in the same order as
provided in the construtor. The caller&#39;s block is invoked with
parameters of the task, a <a href="Section.html">Section</a>, a flag
indicating that the task started a new <a href="Section.html">Section</a>
if true, a <a href="Group.html">Group</a> and a flag indicating that the
task started a new <a href="Group.html">Group</a> if true.</p>
          

          
          <div class="method-source-code" id="each_task-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 270</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_task</span>
  <span class="ruby-identifier">tasks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">task</span> <span class="ruby-operator">|</span>
    <span class="ruby-identifier">section</span>, <span class="ruby-identifier">is_new_section</span>, <span class="ruby-identifier">group</span>, <span class="ruby-identifier">is_new_group</span> = <span class="ruby-identifier">retrieve</span>( <span class="ruby-identifier">task</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> )
    <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">task</span>, <span class="ruby-identifier">section</span>, <span class="ruby-identifier">is_new_section</span>, <span class="ruby-identifier">group</span>, <span class="ruby-identifier">is_new_group</span> )
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_task-source -->
          
        </div>

        

        
      </div><!-- each_task-method -->

    
      <div id="method-i-group" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">group</span><span
            class="method-args">( task_id_str )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Obtain a <a href="Group.html">Group</a> instance related to the given task,
specified as a task ID in string form.</p>
          

          
          <div class="method-source-code" id="group-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 236</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">group</span>( <span class="ruby-identifier">task_id_str</span> )
  <span class="ruby-ivar">@task_to_group_map</span>[ <span class="ruby-identifier">task_id_str</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- group-source -->
          
        </div>

        

        
      </div><!-- group-method -->

    
      <div id="method-i-initialize_sections" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialize_sections</span><span
            class="method-args">( tasks, optionalClass = Section )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Initialize by passing in the array of non-nil <a
href="../Task.html">Task</a> instances that  will be used for group and
section processing. This must already be in an order that makes sense for
such processing, e.g. sorted by project, customer, task title.</p>

<p>Ideally, pass an ActiveRecord::Relation instance that&#39;ll return a set
of appropriately sorted objects for most efficient operation.</p>

<p>In the optional section parameter, pass a Class which will be instantiated
instead of <a href="Section.html">TrackRecordSections::Section</a> whenever
a new section is being defined. The class must include <a
href="SectionMixin.html">SectionMixin</a> along with whatever other
behaviour it might define (which is of interest only to the caller and
ignored herein). The custom class constructor must have the same signature
as, and must call module method “initialize_section()”.</p>
          

          
          <div class="method-source-code" id="initialize_sections-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize_sections</span>( <span class="ruby-identifier">tasks</span>, <span class="ruby-identifier">optionalClass</span> = <span class="ruby-constant">Section</span> )

  <span class="ruby-comment"># Create new Section objects and a map between task IDs and</span>
  <span class="ruby-comment"># those objects, so we can get to them quickly.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># We run through the tasks in the array order. Whether or</span>
  <span class="ruby-comment"># not a task needs a new Section object instance, because</span>
  <span class="ruby-comment"># it represents a hithertoo unencountered project/customer</span>
  <span class="ruby-comment"># combination, tells us that this task&#39;s row will sit at</span>
  <span class="ruby-comment"># the top of a new section in e.g. a generated report. Keep</span>
  <span class="ruby-comment"># track of that flag in another task-keyed hash as it&#39;ll be</span>
  <span class="ruby-comment"># very useful for section-aware generators or similar views.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># Groups are also handled in this loop, creating a set of</span>
  <span class="ruby-comment"># flags, but not needing new section objects. While sections</span>
  <span class="ruby-comment"># are uniquely identified by a combination of project and</span>
  <span class="ruby-comment"># customer, groups are uniquely identified by title. Group</span>
  <span class="ruby-comment"># titles are based upon the presence of colon characters in</span>
  <span class="ruby-comment"># task names (everything up to the first colon).</span>

  <span class="ruby-ivar">@task_to_section_map</span> = {}
  <span class="ruby-ivar">@task_starts_section</span> = {}
  <span class="ruby-ivar">@sections</span>            = {}
  <span class="ruby-identifier">section_identifier</span>   = <span class="ruby-value">0</span>

  <span class="ruby-comment"># Groups are harder as we have to consider the no-colon-in-title</span>
  <span class="ruby-comment"># &quot;ungrouped&quot; tasks and how we need to treat it as a group change</span>
  <span class="ruby-comment"># if we change from ungrouped to group task, or vice versa.</span>

  <span class="ruby-ivar">@task_to_group_map</span>   = {}
  <span class="ruby-ivar">@task_starts_group</span>   = {}
  <span class="ruby-ivar">@groups</span>              = {}
  <span class="ruby-identifier">previous_group_id</span>    = <span class="ruby-keyword">nil</span> <span class="ruby-comment"># Intentional potential first-row match to &quot;ungrouped&quot; task</span>

  <span class="ruby-identifier">tasks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">task</span> <span class="ruby-operator">|</span>
    <span class="ruby-identifier">task_id_str</span> = <span class="ruby-identifier">task</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>

    <span class="ruby-identifier">project_id</span>  = <span class="ruby-identifier">task</span>.<span class="ruby-identifier">project</span>.<span class="ruby-identifier">try</span>( <span class="ruby-value">:id</span> ) <span class="ruby-operator">||</span> <span class="ruby-string">&#39;-&#39;</span>
    <span class="ruby-identifier">customer_id</span> = <span class="ruby-identifier">task</span>.<span class="ruby-identifier">project</span>.<span class="ruby-identifier">try</span>( <span class="ruby-value">:customer</span> ).<span class="ruby-identifier">try</span>( <span class="ruby-value">:id</span> ) <span class="ruby-operator">||</span> <span class="ruby-string">&#39;-&#39;</span>
    <span class="ruby-identifier">section_id</span>  = <span class="ruby-node">&quot;#{ customer_id }_#{ project_id }&quot;</span>
    <span class="ruby-identifier">found</span>       = <span class="ruby-ivar">@sections</span>[ <span class="ruby-identifier">section_id</span> ]

    <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">found</span>.<span class="ruby-identifier">nil?</span> )
      <span class="ruby-ivar">@task_starts_section</span>[ <span class="ruby-identifier">task_id_str</span> ] = <span class="ruby-keyword">true</span>
      <span class="ruby-ivar">@task_to_section_map</span>[ <span class="ruby-identifier">task_id_str</span> ] = <span class="ruby-ivar">@sections</span>[ <span class="ruby-identifier">section_id</span> ] = <span class="ruby-identifier">optionalClass</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">section_identifier</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">task</span>.<span class="ruby-identifier">project</span> )
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@task_starts_section</span>[ <span class="ruby-identifier">task_id_str</span> ] = <span class="ruby-keyword">false</span>
      <span class="ruby-ivar">@task_to_section_map</span>[ <span class="ruby-identifier">task_id_str</span> ] = <span class="ruby-identifier">found</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">group</span>    = <span class="ruby-constant">Group</span>.<span class="ruby-identifier">new</span>( <span class="ruby-identifier">task</span> )
    <span class="ruby-identifier">group_id</span> = <span class="ruby-identifier">group</span>.<span class="ruby-identifier">title</span>()
    <span class="ruby-identifier">found</span>    = <span class="ruby-ivar">@groups</span>[ <span class="ruby-identifier">group_id</span> ]

    <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">found</span>.<span class="ruby-identifier">nil?</span> )
      <span class="ruby-ivar">@task_starts_group</span>[ <span class="ruby-identifier">task_id_str</span> ] = <span class="ruby-keyword">true</span>
      <span class="ruby-ivar">@task_to_group_map</span>[ <span class="ruby-identifier">task_id_str</span> ] = <span class="ruby-ivar">@groups</span>[ <span class="ruby-identifier">group_id</span> ] = <span class="ruby-identifier">group</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@task_starts_group</span>[ <span class="ruby-identifier">task_id_str</span> ] = ( <span class="ruby-identifier">previous_group_id</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">group_id</span> )
      <span class="ruby-ivar">@task_to_group_map</span>[ <span class="ruby-identifier">task_id_str</span> ] = <span class="ruby-identifier">found</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">previous_group_id</span> = <span class="ruby-identifier">group_id</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialize_sections-source -->
          
        </div>

        

        
      </div><!-- initialize_sections-method -->

    
      <div id="method-i-reassess_start_flags_using" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reassess_start_flags_using</span><span
            class="method-args">( tasks )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>If you want to change the task list at some later time, with some tasks
omitted, call here to retain all section and group data but reasses the
“this task starts a new section/group” flag settings in view of the new
task list.</p>

<p>The new task list can be a reordered version of the original and can have
tasks omitted from the original, but may contain no new tasks. Results are
undefined in such a case.</p>

<p>The internal record of the task list is necessarily updated (else it would
mismatch the flags) so the “<a
href="SectionsMixin.html#method-i-each_task">#each_task</a>” enumerator
will, after calling here, return the new tasks list, not the original.</p>
          

          
          <div class="method-source-code" id="reassess_start_flags_using-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 309</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reassess_start_flags_using</span>( <span class="ruby-identifier">tasks</span> )
  <span class="ruby-identifier">previous_section</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">previous_group</span>   = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">tasks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">task</span> <span class="ruby-operator">|</span>
    <span class="ruby-identifier">task_id_str</span> = <span class="ruby-identifier">task</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-identifier">s</span>           = <span class="ruby-identifier">section</span>( <span class="ruby-identifier">task_id_str</span> )
    <span class="ruby-identifier">g</span>           = <span class="ruby-identifier">group</span>( <span class="ruby-identifier">task_id_str</span> )

    <span class="ruby-ivar">@task_starts_section</span>[ <span class="ruby-identifier">task_id_str</span> ] = ( <span class="ruby-identifier">s</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">previous_section</span> )
    <span class="ruby-ivar">@task_starts_group</span>  [ <span class="ruby-identifier">task_id_str</span> ] = ( <span class="ruby-identifier">g</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">previous_group</span>   )

    <span class="ruby-identifier">previous_section</span> = <span class="ruby-identifier">s</span>
    <span class="ruby-identifier">previous_group</span>   = <span class="ruby-identifier">g</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- reassess_start_flags_using-source -->
          
        </div>

        

        
      </div><!-- reassess_start_flags_using-method -->

    
      <div id="method-i-retrieve" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">retrieve</span><span
            class="method-args">( task_id_str )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>For the given task, which must be an instance present in the array of tasks
given in the constructor, retrieve an array containing in order first to
last index: a <a href="Section.html">Section</a>, a flag indicating that
the task started a new <a href="Section.html">Section</a> if true, a <a
href="Group.html">Group</a> and a flag indicating that the task started a
new <a href="Group.html">Group</a> if true.</p>

<p>The task must be specified by its ID, as a string.</p>
          

          
          <div class="method-source-code" id="retrieve-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 255</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">retrieve</span>( <span class="ruby-identifier">task_id_str</span> )
  [
    <span class="ruby-ivar">@task_to_section_map</span>[ <span class="ruby-identifier">task_id_str</span> ],
    <span class="ruby-ivar">@task_starts_section</span>[ <span class="ruby-identifier">task_id_str</span> ],
    <span class="ruby-ivar">@task_to_group_map</span>  [ <span class="ruby-identifier">task_id_str</span> ],
    <span class="ruby-ivar">@task_starts_group</span>  [ <span class="ruby-identifier">task_id_str</span> ]
  ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- retrieve-source -->
          
        </div>

        

        
      </div><!-- retrieve-method -->

    
      <div id="method-i-section" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">section</span><span
            class="method-args">( task_id_str )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Obtain a <a href="Section.html">Section</a> instance related to the given
task, specified as a task ID in string form.</p>
          

          
          <div class="method-source-code" id="section-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 222</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">section</span>( <span class="ruby-identifier">task_id_str</span> )
  <span class="ruby-ivar">@task_to_section_map</span>[ <span class="ruby-identifier">task_id_str</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- section-source -->
          
        </div>

        

        
      </div><!-- section-method -->

    
      <div id="method-i-starts_new_group-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">starts_new_group?</span><span
            class="method-args">( task_id_str )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns &#39;true&#39; if the given task, specified as a task ID in string
form, starts a new <a href="Group.html">Group</a>.</p>
          

          
          <div class="method-source-code" id="starts_new_group-3F-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 243</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">starts_new_group?</span>( <span class="ruby-identifier">task_id_str</span> )
  <span class="ruby-ivar">@task_starts_group</span>[ <span class="ruby-identifier">task_id_str</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- starts_new_group-3F-source -->
          
        </div>

        

        
      </div><!-- starts_new_group-3F-method -->

    
      <div id="method-i-starts_new_section-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">starts_new_section?</span><span
            class="method-args">( task_id_str )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Returns &#39;true&#39; if the given task, specified as a task ID in string
form, starts a new <a href="Section.html">Section</a>.</p>
          

          
          <div class="method-source-code" id="starts_new_section-3F-source">
            <pre><span class="ruby-comment"># File lib/track_record_sections.rb, line 229</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">starts_new_section?</span>( <span class="ruby-identifier">task_id_str</span> )
  <span class="ruby-ivar">@task_starts_section</span>[ <span class="ruby-identifier">task_id_str</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- starts_new_section-3F-source -->
          
        </div>

        

        
      </div><!-- starts_new_section-3F-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.2.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

