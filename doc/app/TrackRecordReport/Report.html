<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">

<title>class TrackRecordReport::Report - TrackRecord</title>

<link type="text/css" media="screen" href="../rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "../";
</script>

<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="../index.html">Home</a>
    <a href="../table_of_contents.html#classes">Classes</a>
    <a href="../table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>lib/track_record_report.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link"><a href="CalculatorWithUsers.html">TrackRecordReport::CalculatorWithUsers</a>
  
</nav>

    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="../TrackRecordSections/SectionsMixin.html">TrackRecordSections::SectionsMixin</a>
  
  
  </ul>
</nav>

    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-label">::label</a>
    
    <li><a href="#method-c-labels">::labels</a>
    
    <li><a href="#method-c-new">::new</a>
    
    <li><a href="#method-i-active_task_ids-3D">#active_task_ids=</a>
    
    <li><a href="#method-i-active_tasks">#active_tasks</a>
    
    <li><a href="#method-i-column_count">#column_count</a>
    
    <li><a href="#method-i-column_heading">#column_heading</a>
    
    <li><a href="#method-i-column_title">#column_title</a>
    
    <li><a href="#method-i-column_total">#column_total</a>
    
    <li><a href="#method-i-column_total-21">#column_total!</a>
    
    <li><a href="#method-i-compile">#compile</a>
    
    <li><a href="#method-i-display_range">#display_range</a>
    
    <li><a href="#method-i-each_cell_for">#each_cell_for</a>
    
    <li><a href="#method-i-each_cell_for_user_on_row">#each_cell_for_user_on_row</a>
    
    <li><a href="#method-i-each_column_range">#each_column_range</a>
    
    <li><a href="#method-i-each_column_total">#each_column_total</a>
    
    <li><a href="#method-i-each_row">#each_row</a>
    
    <li><a href="#method-i-each_user">#each_user</a>
    
    <li><a href="#method-i-each_user_on_row">#each_user_on_row</a>
    
    <li><a href="#method-i-frequency-3D">#frequency=</a>
    
    <li><a href="#method-i-has_rows-3F">#has_rows?</a>
    
    <li><a href="#method-i-inactive_task_ids-3D">#inactive_task_ids=</a>
    
    <li><a href="#method-i-inactive_tasks">#inactive_tasks</a>
    
    <li><a href="#method-i-label">#label</a>
    
    <li><a href="#method-i-partial_column-3F">#partial_column?</a>
    
    <li><a href="#method-i-range_end-3D">#range_end=</a>
    
    <li><a href="#method-i-range_month_end-3D">#range_month_end=</a>
    
    <li><a href="#method-i-range_month_start-3D">#range_month_start=</a>
    
    <li><a href="#method-i-range_one_month-3D">#range_one_month=</a>
    
    <li><a href="#method-i-range_one_week-3D">#range_one_week=</a>
    
    <li><a href="#method-i-range_start-3D">#range_start=</a>
    
    <li><a href="#method-i-range_week_end-3D">#range_week_end=</a>
    
    <li><a href="#method-i-range_week_start-3D">#range_week_start=</a>
    
    <li><a href="#method-i-reportable_user_ids-3D">#reportable_user_ids=</a>
    
    <li><a href="#method-i-row">#row</a>
    
    <li><a href="#method-i-row-21">#row!</a>
    
    <li><a href="#method-i-task_ids-3D">#task_ids=</a>
    
    <li><a href="#method-i-tasks-3D">#tasks=</a>
    
    <li><a href="#method-i-user_count">#user_count</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="../CHANGELOG_rdoc.html">CHANGELOG</a>
  
    <li class="file"><a href="../README_rdoc.html">README</a>
  
    <li class="file"><a href="../doc/README_FOR_APP_rdoc.html">README_FOR_APP</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="../TrackRecordReport.html">TrackRecordReport</a>
  
    <li><a href="../TrackRecordReport/Calculator.html">TrackRecordReport::Calculator</a>
  
    <li><a href="../TrackRecordReport/CalculatorWithUsers.html">TrackRecordReport::CalculatorWithUsers</a>
  
    <li><a href="../TrackRecordReport/Cell.html">TrackRecordReport::Cell</a>
  
    <li><a href="../TrackRecordReport/Report.html">TrackRecordReport::Report</a>
  
    <li><a href="../TrackRecordReport/Row.html">TrackRecordReport::Row</a>
  
    <li><a href="../TrackRecordReport/Section.html">TrackRecordReport::Section</a>
  
    <li><a href="../TrackRecordSections.html">TrackRecordSections</a>
  
    <li><a href="../TrackRecordSections/Group.html">TrackRecordSections::Group</a>
  
    <li><a href="../TrackRecordSections/GroupMixin.html">TrackRecordSections::GroupMixin</a>
  
    <li><a href="../TrackRecordSections/Section.html">TrackRecordSections::Section</a>
  
    <li><a href="../TrackRecordSections/SectionMixin.html">TrackRecordSections::SectionMixin</a>
  
    <li><a href="../TrackRecordSections/Sections.html">TrackRecordSections::Sections</a>
  
    <li><a href="../TrackRecordSections/SectionsMixin.html">TrackRecordSections::SectionsMixin</a>
  
    <li><a href="../ReportsHelper.html">ReportsHelper</a>
  
    <li><a href="../ReportsHelper/ReportMonth.html">ReportsHelper::ReportMonth</a>
  
    <li><a href="../ReportsHelper/ReportWeek.html">ReportsHelper::ReportWeek</a>
  
    <li><a href="../ReportsHelper/ReportYear.html">ReportsHelper::ReportYear</a>
  
    <li><a href="../QuietLeightbox.html">QuietLeightbox</a>
  
    <li><a href="../QuietLeightbox/ClassMethods.html">QuietLeightbox::ClassMethods</a>
  
    <li><a href="../QuietLeightbox/QuietLeightboxHelper.html">QuietLeightbox::QuietLeightboxHelper</a>
  
    <li><a href="../QuietPrototype.html">QuietPrototype</a>
  
    <li><a href="../QuietPrototype/ClassMethods.html">QuietPrototype::ClassMethods</a>
  
    <li><a href="../QuietPrototype/QuietPrototypeHelper.html">QuietPrototype::QuietPrototypeHelper</a>
  
    <li><a href="../YuiTree.html">YuiTree</a>
  
    <li><a href="../YuiTree/ClassMethods.html">YuiTree::ClassMethods</a>
  
    <li><a href="../YuiTree/YuiTreeHelper.html">YuiTree::YuiTreeHelper</a>
  
    <li><a href="../TrackRecordReportGenerator.html">TrackRecordReportGenerator</a>
  
    <li><a href="../TrackRecordReportGenerator/UkOrgPondCSV.html">TrackRecordReportGenerator::UkOrgPondCSV</a>
  
    <li><a href="../ApplicationController.html">ApplicationController</a>
  
    <li><a href="../ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="../AuditsController.html">AuditsController</a>
  
    <li><a href="../AuditsHelper.html">AuditsHelper</a>
  
    <li><a href="../ChartsController.html">ChartsController</a>
  
    <li><a href="../ChartsHelper.html">ChartsHelper</a>
  
    <li><a href="../ControlPanel.html">ControlPanel</a>
  
    <li><a href="../ControlPanelsController.html">ControlPanelsController</a>
  
    <li><a href="../Customer.html">Customer</a>
  
    <li><a href="../CustomersController.html">CustomersController</a>
  
    <li><a href="../CustomersHelper.html">CustomersHelper</a>
  
    <li><a href="../EmailNotifier.html">EmailNotifier</a>
  
    <li><a href="../HelpController.html">HelpController</a>
  
    <li><a href="../HelpHelper.html">HelpHelper</a>
  
    <li><a href="../Project.html">Project</a>
  
    <li><a href="../ProjectsController.html">ProjectsController</a>
  
    <li><a href="../ProjectsHelper.html">ProjectsHelper</a>
  
    <li><a href="../Rangeable.html">Rangeable</a>
  
    <li><a href="../ReportsController.html">ReportsController</a>
  
    <li><a href="../SavedReport.html">SavedReport</a>
  
    <li><a href="../SavedReportAutoTitlesController.html">SavedReportAutoTitlesController</a>
  
    <li><a href="../SavedReportsBaseController.html">SavedReportsBaseController</a>
  
    <li><a href="../SavedReportsByCustomerController.html">SavedReportsByCustomerController</a>
  
    <li><a href="../SavedReportsByProjectController.html">SavedReportsByProjectController</a>
  
    <li><a href="../SavedReportsByTaskController.html">SavedReportsByTaskController</a>
  
    <li><a href="../SavedReportsByUserController.html">SavedReportsByUserController</a>
  
    <li><a href="../SavedReportsController.html">SavedReportsController</a>
  
    <li><a href="../SavedReportsHelper.html">SavedReportsHelper</a>
  
    <li><a href="../SessionsController.html">SessionsController</a>
  
    <li><a href="../SignIn.html">SignIn</a>
  
    <li><a href="../Task.html">Task</a>
  
    <li><a href="../TaskGroup.html">TaskGroup</a>
  
    <li><a href="../TaskImport.html">TaskImport</a>
  
    <li><a href="../TaskImportsController.html">TaskImportsController</a>
  
    <li><a href="../TaskImportsHelper.html">TaskImportsHelper</a>
  
    <li><a href="../TasksController.html">TasksController</a>
  
    <li><a href="../TasksHelper.html">TasksHelper</a>
  
    <li><a href="../Timesheet.html">Timesheet</a>
  
    <li><a href="../TimesheetForceCommit.html">TimesheetForceCommit</a>
  
    <li><a href="../TimesheetForceCommitsController.html">TimesheetForceCommitsController</a>
  
    <li><a href="../TimesheetRow.html">TimesheetRow</a>
  
    <li><a href="../TimesheetRowsController.html">TimesheetRowsController</a>
  
    <li><a href="../TimesheetRowsHelper.html">TimesheetRowsHelper</a>
  
    <li><a href="../TimesheetsController.html">TimesheetsController</a>
  
    <li><a href="../TimesheetsHelper.html">TimesheetsHelper</a>
  
    <li><a href="../TreesController.html">TreesController</a>
  
    <li><a href="../User.html">User</a>
  
    <li><a href="../UsersController.html">UsersController</a>
  
    <li><a href="../UsersHelper.html">UsersHelper</a>
  
    <li><a href="../WorkPacket.html">WorkPacket</a>
  
    <li><a href="../WorkPacketsController.html">WorkPacketsController</a>
  
    <li><a href="../WorkPacketsHelper.html">WorkPacketsHelper</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class TrackRecordReport::Report</h1>

  <div id="description" class="description">
    
<p>A <a href="Report.html">Report</a> object queries the database for a set of
numbers and compiles them into a set of Sections, Rows and Cells which can
be queried via a accessors and enumerators provided herein.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <!-- Constants -->
    <section id="constants-list" class="section">
      <h3 class="section-header">Constants</h3>
      <dl>
      
        <dt id="FREQUENCY">FREQUENCY
        
        <dd class="description"><p>Configure the handlers and human-readable labels for the ways in which
reports get broken up, in terms of frequency. View code which presents a
choice of report frequency should obtain the labels for the list with the
‘label’ method. Use the ‘<a
href="Report.html#method-i-column_title">#column_title</a>’ method for a
column “title”, shown alongside or above column headings. Use the ‘<a
href="Report.html#method-i-column_heading">#column_heading</a>’ method for
per-column headings.</p>

<p><em>These must stay in the same order!</em></p>

<p>If you add new entries, you must add them at the end of the list.</p>

<p>Saved reports specify the reporting frequency by reference to this constant
and an index into its array of entries. If you produce a new TrackRecord
version that changes the meaning of any array index rather than merely
adding new entries, you will have to include a migration that maps old
indices to new for existing saved report records.</p>

<h2 id="label-IMPORTANT%21+Database+dependence">IMPORTANT! Database dependence</h2>

<p><em>Executive summary: Reports are fast on PostgreSQL and slow on anything
else, unless you take steps to make sure they run quickly.</em></p>

<p>To run report sums in the database quickly, with minimum queries, the
database is asked to group its calculations. When we can group using
something that matches the columns of a report, we can get the database to
in effect calculate the entire body of the report in one query. So for
example, a monthly report would group by year and month number; any given
date produces a unique year and month.</p>

<p>To do this, the SQL ‘EXTRACT’ function is used by default.</p>
<ul><li>
<p><a
href="http://www.postgresql.org/docs/8.3/static/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT">www.postgresql.org/docs/8.3/static/functions-datetime.html#FUNCTIONS-DATETIME-EXTRACT</a></p>
</li><li>
<p><a
href="http://www.w3schools.com/sql/func_extract.asp">www.w3schools.com/sql/func_extract.asp</a></p>
</li><li>
<p><a
href="http://docs.oracle.com/cd/B19306_01/server.102/b14200/functions050.htm">docs.oracle.com/cd/B19306_01/server.102/b14200/functions050.htm</a></p>
</li></ul>

<p>With the standard report generator implementation, TrackRecord reports rely
on being able to extract:</p>
<ul><li>
<p>YEAR (must match Ruby Date#year, i.e. numeric, four digit standard calendar
year)</p>
</li><li>
<p>QUARTER (must match Ruby Date#quarter, i.e. numeric 1-4, simple 3 full
month splits)</p>
</li><li>
<p>MONTH (must match Ruby Date#month, i.e. numeric 1-12)</p>
</li><li>
<p><em>WEEK - see below - so also ISOYEAR (PostgreSQL v8.3+ specific)</em></p>
<ul><li>
<p>Ruby mirrors ISOYEAR with Date#cwyear. PostgreSQL v8.3 and later also</p>
</li></ul>

<p>provide ISODOW (day-of-week), equivalent to Ruby’s Date#cwday, but that is
not needed by TrackRecord.</p>
</li></ul>

<p>Weekly reports are thorny, because that requires grouping by some idea of a
unique numbered week. The commercial week number is the obvious choice.
MySQL and PostgreSQL provide a WEEK parameter for this in EXTRACT, but
<em>Oracle does not offer this and can’t be used</em> without changing the
TrackRecord report generator’s <a
href="Report.html#FREQUENCY">FREQUENCY</a> constant for weekly reports, or
disabling weekly reports entirely.</p>

<p>In any case, even that is insufficient. The 31st December 2012 marks the
start of commercial week number 1 for the commercial year 2013; but the
date itself is in calendar year 2012. January 1st 2006 is actually the last
day of commercial week 52 in the commercial year 2005, despite the date
being in calendar year 2006. If we were to just use a standard calendar
year, we’d get into trouble - 2012 would appear to contain week 1 twice,
leading to numbers from entirely different time periods being combined in
the report calculations.</p>

<p>Thus <em>&lt;strong&gt;weekly reports will only function if you use
PostgreSQL version 8.3 or later&lt;/strong&gt;</em> unless you modify the
report code. Without modifications, Oracle and MySQL should work (but are
not tested). Note that SQLite will <em>&lt;strong&gt;not work at
all&lt;/strong&gt;</em> as it has no support for EXTRACT at all - you need
to use ‘strftime’ instead, and this provides easily enough flexibility to
support weekly reports too:</p>
<ul><li>
<p><a
href="http://www.sqlite.org/lang_datefunc.html">www.sqlite.org/lang_datefunc.html</a></p>
</li><li>
<p><a
href="http://stackoverflow.com/questions/9624601/activerecord-find-by-year-day-or-month-on-a-date-field">stackoverflow.com/questions/9624601/activerecord-find-by-year-day-or-month-on-a-date-field</a></p>
</li></ul>

<p>To modify <a href="Report.html#FREQUENCY">FREQUENCY</a> for a different
database:</p>
<ol><li>
<p>Change “config/initializers/can_database_do_fast_reports.rb” so that the
SLOW_DATABASE_ALTERNATIVE constant value is “false” for your database.
Without this, you won’t be able to test your modifications to <a
href="Report.html#FREQUENCY">FREQUENCY</a> as a “safe mode” fallback is
active.</p>
</li><li>
<p>Change the “:grouping” key to the equivalent of the EXTRACT already
present, noting that it shoudld always be an array, even if there’s only
one group. Ensure that whatever you group by will lead to one group for
every single unique column for the intended report, e.g. uniquely
identifies months across many years, or weeks across awkward end-of-year
boundaries.</p>
</li><li>
<p>Change the “:date_to_key” proc so that Ruby generates an array that matches
the grouping keys returned by the database when it runs the query that
calculates the report data. To find out that bit of the puzzle, search in
“lib/track_record_report.rb” (i.e. this file) for the string
“*date_based_key”. You’ll see a line of code that assigns this from a
variable. Underneath that line, add in: “raise date_based_key.inspect” and
generate a report of the column duration you are modifying, while in
development mode. The raised exception will show in your browser the form
of the value that the date-to-key proc must return.</p>
</li></ol>

<p>Also look at the code below the assignment of <a
href="Report.html#FREQUENCY">FREQUENCY</a> to see how the slow “safe mode”
is done. You could always create those values inside <a
href="Report.html#FREQUENCY">FREQUENCY</a> by hand for report types you
can’t generate in the database.</p>
        
      
      </dl>
    </section>
    

    
    <!-- Attributes -->
    <section id="attribute-method-details" class="method-section section">
      <h3 class="section-header">Attributes</h3>

      
      <div id="attribute-i-active_task_ids" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">active_task_ids</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-cacheable_end_indicator" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">cacheable_end_indicator</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>“Cacheable” range values. If a report’s start or end date is fixed, returns
the date. If the start or end date are start/end-of-all-time, one or both
returns :all. If the report is being generated for a relative month or
week, returns “last_”, “this_” or “two_” with a suffix of “month” or
“week”, as a symbol, for both start and end.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-cacheable_start_indicator" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">cacheable_start_indicator</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>“Cacheable” range values. If a report’s start or end date is fixed, returns
the date. If the start or end date are start/end-of-all-time, one or both
returns :all. If the report is being generated for a relative month or
week, returns “last_”, “this_” or “two_” with a suffix of “month” or
“week”, as a symbol, for both start and end.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-customer_sort_field" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">customer_sort_field</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Sort fields for customers, projects and tasks; grouping options.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-filtered_tasks" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">filtered_tasks</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-filtered_users" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">filtered_users</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-frequency" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">frequency</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>A row from the <a href="Report.html#FREQUENCY">FREQUENCY</a> constant and
the current index into that array.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-frequency_data" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">frequency_data</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>A row from the <a href="Report.html#FREQUENCY">FREQUENCY</a> constant and
the current index into that array.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-inactive_task_ids" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">inactive_task_ids</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-project_sort_field" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">project_sort_field</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Sort fields for customers, projects and tasks; grouping options.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-range" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Complete date range for the whole report; array of user IDs used for
per-user breakdowns; array of task IDs the report will represent.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-range_end" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_end</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Range data for the ‘new’ view form. Custom attribute writer methods are
used to call “rationalise_dates” whenever a range value is altered.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-range_month_end" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_month_end</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-range_month_start" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_month_start</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-range_one_month" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_one_month</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-range_one_week" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_one_week</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-range_start" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_start</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Range data for the ‘new’ view form. Custom attribute writer methods are
used to call “rationalise_dates” whenever a range value is altered.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-range_week_end" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_week_end</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-range_week_start" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">range_week_start</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-reportable_user_ids" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">reportable_user_ids</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-task_filter" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">task_filter</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Handle all (“all”), only billable (“billable”) or only non-billable
(“non_billable”) tasks?</p>
        
        </div>
      </div>
      
      <div id="attribute-i-task_grouping" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">task_grouping</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-task_ids" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">task_ids</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-task_sort_field" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">task_sort_field</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Sort fields for customers, projects and tasks; grouping options.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-tasks" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">tasks</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Read-only array of actual user and task objects based on the IDs. Not all
users or tasks may be included, depending on security settings.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-throttled" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">throttled</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>A report’s total date span may be restricted to avoid generating giant
reports which would swamp a server (for example, a daily report over
hundreds or thousands of days would be a bad idea). If not done, this holds
‘nil’, else the Date giving the <strong>original</strong> start date (the
limited, actual start date used is in the “range” property).</p>

<p>Views/generators can use it to include warnings that the start date was
limited, should they so wish.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-title" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">title</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        <p>Optional report title.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-total_actual_remaining" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">total_actual_remaining</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Total duration of all tasks in all rows; number of hours remaining (may be
negative for overrun) after all hours worked in tasks with non-zero
duration. If ‘nil’, <strong>all</strong> tasks had zero duration. The
‘actual’ value only accounts for committed hours, while the ‘potential’
value includes both committed and not-committed hours (thus, subject to
change).</p>

<p>A report that hides zero total rows will not include task durations on
those rows. A report that shows them <strong>will</strong> include task
durations on those rows.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-total_duration" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">total_duration</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Total duration of all tasks in all rows; number of hours remaining (may be
negative for overrun) after all hours worked in tasks with non-zero
duration. If ‘nil’, <strong>all</strong> tasks had zero duration. The
‘actual’ value only accounts for committed hours, while the ‘potential’
value includes both committed and not-committed hours (thus, subject to
change).</p>

<p>A report that hides zero total rows will not include task durations on
those rows. A report that shows them <strong>will</strong> include task
durations on those rows.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-total_potential_remaining" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">total_potential_remaining</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Total duration of all tasks in all rows; number of hours remaining (may be
negative for overrun) after all hours worked in tasks with non-zero
duration. If ‘nil’, <strong>all</strong> tasks had zero duration. The
‘actual’ value only accounts for committed hours, while the ‘potential’
value includes both committed and not-committed hours (thus, subject to
change).</p>

<p>A report that hides zero total rows will not include task durations on
those rows. A report that shows them <strong>will</strong> include task
durations on those rows.</p>
        
        </div>
      </div>
      
      <div id="attribute-i-users" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">users</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>Read-only array of actual user and task objects based on the IDs. Not all
users or tasks may be included, depending on security settings.</p>
        
        </div>
      </div>
      
    </section><!-- attribute-method-details -->
    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-label" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">label</span><span
            class="method-args">( frequency )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Class method equivalent of “label” above. Returns the label for the given
frequency, which must be a valid index into the array defined by the <a
href="Report.html#FREQUENCY">FREQUENCY</a> constant. See also “labels”
below.</p>
          

          
          <div class="method-source-code" id="label-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 901</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">label</span>( <span class="ruby-identifier">frequency</span> )
  <span class="ruby-keyword">return</span> <span class="ruby-constant">Report</span><span class="ruby-operator">::</span><span class="ruby-constant">FREQUENCY</span>[ <span class="ruby-identifier">frequency</span> ][ <span class="ruby-value">:label</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- label-source -->
          
        </div>

        

        
      </div><!-- label-method -->

    
      <div id="method-c-labels" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">labels</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Class method which returns an array of labels for various report
frequencies. The index into the array indicates the frequency index.</p>
          

          
          <div class="method-source-code" id="labels-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 908</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">labels</span>
  <span class="ruby-keyword">return</span> <span class="ruby-constant">Report</span><span class="ruby-operator">::</span><span class="ruby-constant">FREQUENCY</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">f</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>[ <span class="ruby-value">:label</span> ] }
<span class="ruby-keyword">end</span></pre>
          </div><!-- labels-source -->
          
        </div>

        

        
      </div><!-- labels-method -->

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">( current_user, params = nil )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Create a new <a href="Report.html">Report</a>. In the first parameter, pass
the current TrackRecord user. In the next parameter pass nothing to use
default values for a ‘new report’ view form, or pass “params[ :report ]”
(or similar) to create using a params hash from a ‘new report’ form
submission.</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 496</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>( <span class="ruby-identifier">current_user</span>, <span class="ruby-identifier">params</span> = <span class="ruby-keyword">nil</span> )

  <span class="ruby-keyword">super</span>()

  <span class="ruby-ivar">@current_user</span>          = <span class="ruby-identifier">current_user</span>

  <span class="ruby-ivar">@range_start</span>           = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@range_end</span>             = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@range_week_start</span>      = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@range_week_end</span>        = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@range_month_start</span>     = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@range_month_end</span>       = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@frequency</span>             = <span class="ruby-value">0</span>

  <span class="ruby-ivar">@customer_sort_field</span>   = <span class="ruby-string">'title'</span>
  <span class="ruby-ivar">@project_sort_field</span>    = <span class="ruby-string">'title'</span>
  <span class="ruby-ivar">@task_sort_field</span>       = <span class="ruby-constant">Task</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_SORT_COLUMN</span>
  <span class="ruby-ivar">@task_grouping</span>         = <span class="ruby-value">:default</span>
  <span class="ruby-ivar">@task_filter</span>           = <span class="ruby-string">'all'</span>

  <span class="ruby-ivar">@include_totals</span>        = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@include_committed</span>     = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@include_not_committed</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@exclude_zero_rows</span>     = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@exclude_zero_cols</span>     = <span class="ruby-keyword">false</span> <span class="ruby-comment"># Totals only - ignores zero com/non-com columns in CSV exports for total/com/non-com column groups with non-zero totals</span>

  <span class="ruby-ivar">@rows</span>                  = {}
  <span class="ruby-ivar">@column_totals</span>         = {}
  <span class="ruby-ivar">@column_ranges</span>         = []
  <span class="ruby-ivar">@column_keys</span>           = []

  <span class="ruby-ivar">@tasks</span>                 = <span class="ruby-constant">Task</span>.<span class="ruby-identifier">scoped</span>
  <span class="ruby-ivar">@filtered_tasks</span>        = <span class="ruby-constant">Task</span>.<span class="ruby-identifier">scoped</span>
  <span class="ruby-ivar">@task_ids</span>              = []
  <span class="ruby-ivar">@active_task_ids</span>       = []
  <span class="ruby-ivar">@inactive_task_ids</span>     = []

  <span class="ruby-ivar">@users</span>                 = []
  <span class="ruby-ivar">@filtered_users</span>        = []
  <span class="ruby-ivar">@reportable_user_ids</span>   = []

  <span class="ruby-keyword">unless</span> ( <span class="ruby-identifier">params</span>.<span class="ruby-identifier">nil?</span> )

    <span class="ruby-comment"># Adapted from ActiveRecord::Base &quot;attributes=&quot;, Rails 2.1.0</span>
    <span class="ruby-comment"># on 29-Jun-2008.</span>

    <span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">params</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">stringify_keys!</span>
    <span class="ruby-identifier">attributes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span> <span class="ruby-operator">|</span>
      <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">key</span>.<span class="ruby-identifier">include?</span>( <span class="ruby-string">'('</span> ) )
        <span class="ruby-identifier">raise</span>( <span class="ruby-string">&quot;Multi-parameter attributes are not supported.&quot;</span> )
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">begin</span>
          <span class="ruby-identifier">send</span>( <span class="ruby-identifier">key</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;=&quot;</span>, <span class="ruby-identifier">value</span> )
        <span class="ruby-keyword">rescue</span>
          <span class="ruby-comment"># Ignore errors</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-active_task_ids-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">active_task_ids=</span><span
            class="method-args">( ids )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Build the ‘tasks’ array if ‘<a
href="Report.html#attribute-i-active_task_ids">#active_task_ids</a>’ is
updated externally. The result will be the sum of existing inactive and
updated active task IDs.</p>
          

          
          <div class="method-source-code" id="active_task_ids-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 595</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">active_task_ids=</span>( <span class="ruby-identifier">ids</span> )
  <span class="ruby-ivar">@provided_active_task_ids</span> = <span class="ruby-identifier">map_raw_ids</span>( <span class="ruby-identifier">ids</span> )
  <span class="ruby-identifier">assign_actual_tasks_from_provided_ids</span>()
<span class="ruby-keyword">end</span></pre>
          </div><!-- active_task_ids-3D-source -->
          
        </div>

        

        
      </div><!-- active_task_ids-3D-method -->

    
      <div id="method-i-active_tasks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">active_tasks</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Virtual accessor for the active task list, which just filters the master
task list and returns the result (less RAM than keeping dual lists and not
speed-critical as not used that often in practice).</p>
          

          
          <div class="method-source-code" id="active_tasks-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 562</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">active_tasks</span>
  <span class="ruby-ivar">@tasks</span>.<span class="ruby-identifier">where</span>( <span class="ruby-value">:active</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span> )
<span class="ruby-keyword">end</span></pre>
          </div><!-- active_tasks-source -->
          
        </div>

        

        
      </div><!-- active_tasks-method -->

    
      <div id="method-i-column_count" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column_count</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Returns the number of columns the report generated, taking into account
zero total columns and the “hide zero columns” flag.</p>
          

          
          <div class="method-source-code" id="column_count-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 813</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">column_count</span>
  <span class="ruby-ivar">@relevant_column_keys</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- column_count-source -->
          
        </div>

        

        
      </div><!-- column_count-method -->

    
      <div id="method-i-column_heading" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column_heading</span><span
            class="method-args">( range, plain_text = false )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Helper method which returns a user-displayable column heading appropriate
for the report type. Pass a column range (see e.g. “<a
href="Report.html#method-i-each_column_range">#each_column_range</a>”).
Optionally pass “true” to replace “&lt;br /&gt;” with a space (if present)
in the heading, for a plain text alternative.</p>
          

          
          <div class="method-source-code" id="column_heading-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 925</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">column_heading</span>( <span class="ruby-identifier">range</span>, <span class="ruby-identifier">plain_text</span> = <span class="ruby-keyword">false</span> )
  <span class="ruby-identifier">heading</span> = <span class="ruby-identifier">send</span>( <span class="ruby-ivar">@frequency_data</span>[ <span class="ruby-value">:column</span> ], <span class="ruby-identifier">range</span> )
  <span class="ruby-identifier">plain_text</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">heading</span>.<span class="ruby-identifier">gsub</span>( <span class="ruby-string">&quot;&lt;br /&gt;&quot;</span>, <span class="ruby-string">&quot; &quot;</span> ) <span class="ruby-operator">:</span> <span class="ruby-identifier">heading</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- column_heading-source -->
          
        </div>

        

        
      </div><!-- column_heading-method -->

    
      <div id="method-i-column_title" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column_title</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Helper method which returns a user-displayable column title to be shown
once, next to or near per-column headings (see “<a
href="Report.html#method-i-column_heading">#column_heading</a>”),
appropriate for the report type.</p>
          

          
          <div class="method-source-code" id="column_title-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 916</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">column_title</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@frequency_data</span>[ <span class="ruby-value">:title</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- column_title-source -->
          
        </div>

        

        
      </div><!-- column_title-method -->

    
      <div id="method-i-column_total" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column_total</span><span
            class="method-args">( date_based_key )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Return the total value as a <a href="Calculator.html">Calculator</a>
subclass instance for the column identified by the given date-based key.</p>

<p>Will return ‘nil’ if no such non-zero total column exists (yet). Only
really useful if the report has been compiled by calling “compile”.</p>
          

          
          <div class="method-source-code" id="column_total-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 672</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">column_total</span>( <span class="ruby-identifier">date_based_key</span> )
  <span class="ruby-ivar">@column_totals</span>[ <span class="ruby-identifier">date_based_key</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- column_total-source -->
          
        </div>

        

        
      </div><!-- column_total-method -->

    
      <div id="method-i-column_total-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">column_total!</span><span
            class="method-args">( date_based_key )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Return the total value as a <a href="Cell.html">Cell</a> instance for the
column identified by the given date-based key. A <a
href="Cell.html">Cell</a> class is used so that per-user column totals can
be maintained. Think of each column total as a cell in an extra total-based
row of the report.</p>

<p>Will create an empty zero-hour <a href="Cell.html">Cell</a> subclass
instance in passing if necessary. Usually only useful during the process of
report compilation (see “compile”) but may have specialist external uses
too.</p>
          

          
          <div class="method-source-code" id="column_total-21-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 686</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">column_total!</span>( <span class="ruby-identifier">date_based_key</span> )
  <span class="ruby-ivar">@column_totals</span>[ <span class="ruby-identifier">date_based_key</span> ] <span class="ruby-operator">||=</span> <span class="ruby-constant">Cell</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- column_total-21-source -->
          
        </div>

        

        
      </div><!-- column_total-21-method -->

    
      <div id="method-i-compile" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">compile</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Compile the report. Returns ‘self’ for convenience.</p>
          

          
          <div class="method-source-code" id="compile-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 869</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">compile</span>
  <span class="ruby-identifier">apply_filters</span>()
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> ( <span class="ruby-ivar">@filtered_tasks</span>.<span class="ruby-identifier">count</span>.<span class="ruby-identifier">zero?</span> ) <span class="ruby-comment"># Nothing to do...</span>

  <span class="ruby-identifier">rationalise_dates</span>()
  <span class="ruby-identifier">set_columns</span>()
  <span class="ruby-identifier">sort_and_group</span>()
  <span class="ruby-identifier">initialize_sections</span>( <span class="ruby-ivar">@filtered_tasks</span>, <span class="ruby-constant">Section</span> ) <span class="ruby-comment"># TrackRecordSections::SectionsMixin</span>

  <span class="ruby-identifier">calculate</span>()

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- compile-source -->
          
        </div>

        

        
      </div><!-- compile-method -->

    
      <div id="method-i-display_range" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">display_range</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Helper method which returns a user-displayable range describing the total
date range for this report.</p>
          

          
          <div class="method-source-code" id="display_range-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 893</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">display_range</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">heading_total</span>( <span class="ruby-ivar">@range</span> )
<span class="ruby-keyword">end</span></pre>
          </div><!-- display_range-source -->
          
        </div>

        

        
      </div><!-- display_range-method -->

    
      <div id="method-i-each_cell_for" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_cell_for</span><span
            class="method-args">( row ) { |cell| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Iterate over the cells in a given <a href="Row.html">Row</a> or <a
href="Row.html">Row</a> subclass. Calls a caller-supplied block, passing
the cell instance. Will pass ‘nil’ for cells with a zero hour total (it is
much faster to check for ‘nil’ many times than instantiate a useless cell
object with zero values for its hours).</p>

<p>A ‘nil’ input parameter value is allowed. The caller block will be invoked
with ‘nil’ for each cell that <strong>would</strong> have been on the row
if it existed.</p>
          

          
          <div class="method-source-code" id="each_cell_for-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 729</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_cell_for</span>( <span class="ruby-identifier">row</span> ) <span class="ruby-comment"># :yields: cell</span>

  <span class="ruby-comment"># We use zero column total values to indicate that an associated entry</span>
  <span class="ruby-comment"># in the column ranges should be omitted.</span>

  <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">row</span>.<span class="ruby-identifier">nil?</span> )
    <span class="ruby-ivar">@relevant_column_keys</span>.<span class="ruby-identifier">each</span> { <span class="ruby-keyword">yield</span>( <span class="ruby-keyword">nil</span> ) }
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@relevant_column_keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">date_based_key</span> <span class="ruby-operator">|</span>
      <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">row</span>.<span class="ruby-identifier">cell</span>( <span class="ruby-identifier">date_based_key</span> ) )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_cell_for-source -->
          
        </div>

        

        
      </div><!-- each_cell_for-method -->

    
      <div id="method-i-each_cell_for_user_on_row" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_cell_for_user_on_row</span><span
            class="method-args">( user, row ) { |cell_for_user| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Results of calling here are undefined unless the report parameters tell it
to include per-user details during compilation.</p>

<p>For a given user and row, return cells for that row giving the column based
totals for just that specific user. Zero columns are skipped if “hide zero
columns” is enabled.</p>

<p>This is similar to just doing “<a
href="Report.html#method-i-each_cell_for">#each_cell_for</a>( row )” and
calling the cell’s “user_total” method manually for whatever your current
<a href="../User.html">User</a> of interest happens to be, but calling here
takes care of that for you and deals with ‘nil’ cleanly in passing.</p>

<p>The given <a href="../User.html">User</a> instance must be valid. The given
<a href="Row.html">Row</a> instance may be ‘nil’. If so, either the block
is called with ‘nil’ for each column if “hide zero rows” is disabled, else
it isn’t called at all.</p>
          

          
          <div class="method-source-code" id="each_cell_for_user_on_row-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 796</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_cell_for_user_on_row</span>( <span class="ruby-identifier">user</span>, <span class="ruby-identifier">row</span> ) <span class="ruby-comment"># :yields: cell_for_user</span>
  <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">row</span>.<span class="ruby-identifier">nil?</span> )
    <span class="ruby-ivar">@relevant_column_keys</span>.<span class="ruby-identifier">each</span> { <span class="ruby-keyword">yield</span>( <span class="ruby-keyword">nil</span> ) } <span class="ruby-keyword">unless</span> ( <span class="ruby-ivar">@exclude_zero_rows</span> )
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">user_id_str</span> = <span class="ruby-identifier">user</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span>

    <span class="ruby-ivar">@relevant_column_keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">date_based_key</span> <span class="ruby-operator">|</span>
      <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">row</span>.<span class="ruby-identifier">cell</span>( <span class="ruby-identifier">date_based_key</span> ).<span class="ruby-identifier">try</span>( <span class="ruby-value">:user_total</span>, <span class="ruby-identifier">user_id_str</span> ) )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_cell_for_user_on_row-source -->
          
        </div>

        

        
      </div><!-- each_cell_for_user_on_row-method -->

    
      <div id="method-i-each_column_range" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_column_range</span><span
            class="method-args">() { |column_range| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Iterate over all columns, calling a caller-supplied block with a Range
object describing the Date range for each one, inclusive of column
start/end. Always calls with a valid Range, never ‘nil’.</p>
          

          
          <div class="method-source-code" id="each_column_range-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 836</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_column_range</span> <span class="ruby-comment"># :yields: column_range</span>

  <span class="ruby-comment"># We use zero column total values to indicate that an associated entry</span>
  <span class="ruby-comment"># in the column ranges should be omitted.</span>

  <span class="ruby-ivar">@column_keys</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">date_based_key</span>, <span class="ruby-identifier">linear_column_index</span> <span class="ruby-operator">|</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> ( <span class="ruby-ivar">@exclude_zero_cols</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">not</span> <span class="ruby-ivar">@column_totals</span>.<span class="ruby-identifier">has_key?</span>( <span class="ruby-identifier">date_based_key</span> ) )
    <span class="ruby-keyword">yield</span> <span class="ruby-ivar">@column_ranges</span>[ <span class="ruby-identifier">linear_column_index</span> ]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_column_range-source -->
          
        </div>

        

        
      </div><!-- each_column_range-method -->

    
      <div id="method-i-each_column_total" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_column_total</span><span
            class="method-args">() { |column_total| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Iterate over all column totals, calling the caller-supplied block with a <a
href="Calculator.html">Calculator</a> subclass describing the total for
that column. If the total is zero and ‘hide zero columns’ is disabled, your
block will be called with ‘nil’ for that column.</p>
          

          
          <div class="method-source-code" id="each_column_total-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 824</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_column_total</span> <span class="ruby-comment"># :yields: column_total</span>
  <span class="ruby-ivar">@relevant_column_keys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">date_based_key</span> <span class="ruby-operator">|</span>
    <span class="ruby-keyword">yield</span>( <span class="ruby-ivar">@column_totals</span>[ <span class="ruby-identifier">date_based_key</span> ] )
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_column_total-source -->
          
        </div>

        

        
      </div><!-- each_column_total-method -->

    
      <div id="method-i-each_row" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_row</span><span
            class="method-args">() { |row, task| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Iterate over all defined rows, yielding a caller supplied block passing it
the row and task in task list order. If “hide zero rows” is set, only
defined rows and tasks with non-zero totals will be sent. Otherwise, you
will be called with a row value of ‘nil’ and the task for which the row
total was zero (it is much faster to check for ‘nil’ many times than
instantiate a useless row object with zero values for its hours).</p>
          

          
          <div class="method-source-code" id="each_row-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 710</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_row</span> <span class="ruby-comment"># :yields: row, task</span>
  <span class="ruby-ivar">@filtered_tasks</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">task</span> <span class="ruby-operator">|</span>
    <span class="ruby-identifier">row</span> = <span class="ruby-ivar">@rows</span>[ <span class="ruby-identifier">task</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> ]
    <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">row</span>, <span class="ruby-identifier">task</span> ) <span class="ruby-keyword">unless</span> ( <span class="ruby-ivar">@exclude_zero_rows</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">nil?</span> )
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_row-source -->
          
        </div>

        

        
      </div><!-- each_row-method -->

    
      <div id="method-i-each_user" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_user</span><span
            class="method-args">() { |user| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Iterate over the list of users passed in the constructor, calling a
caller-supplied block with the <a href="../User.html">User</a> instances in
the order they were originally given. If “hide zero columns” is set, then
only users with a non-zero overall total will be included.</p>
          

          
          <div class="method-source-code" id="each_user-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 863</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_user</span> <span class="ruby-comment"># :yields: user</span>
  <span class="ruby-ivar">@filtered_users</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">user</span> <span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">user</span> ) }
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_user-source -->
          
        </div>

        

        
      </div><!-- each_user-method -->

    
      <div id="method-i-each_user_on_row" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">each_user_on_row</span><span
            class="method-args">( row ) { |user, user_total_for_row| ... }</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Results of calling here are undefined unless the report parameters tell it
to include per-user details during compilation.</p>

<p>For each user associated with a row, call the caller’s block with the <a
href="../User.html">User</a> instance and the <a
href="Calculator.html">Calculator</a> subclass giving the user’s total on
that row. Will call with “nil” for each user in the row is “nil”, unless
“hide zero rows” is enabled, in which case if given nil it will not call
the block at all.</p>

<p>The block is only called for a non-nil row if a user has a non-zero total,
or if “hide zero rows” is disabled, in which case the user total instance
may be ‘nil’ (but the <a href="../User.html">User</a> is always valid).</p>

<p>See also “<a
href="Report.html#method-i-each_cell_for_user_on_row">#each_cell_for_user_on_row</a>”.</p>
          

          
          <div class="method-source-code" id="each_user_on_row-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 760</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">each_user_on_row</span>( <span class="ruby-identifier">row</span> ) <span class="ruby-comment"># :yields: user, user_total_for_row</span>

  <span class="ruby-comment"># Not 'filtered_users' - those are aimed at the columns in reports</span>
  <span class="ruby-comment"># where each *column* represents a user, so hide-zero-columns will</span>
  <span class="ruby-comment"># result in hidden users. Here, we're looking at the per-user</span>
  <span class="ruby-comment"># breakdown for a single task on a row. If hide-zero-cols is set</span>
  <span class="ruby-comment"># but hide-zero-rows is not, we don't want to hide users here.</span>

  <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">row</span>.<span class="ruby-identifier">nil?</span> )
    <span class="ruby-ivar">@users</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">user</span> <span class="ruby-operator">|</span> <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">user</span>, <span class="ruby-keyword">nil</span> ) } <span class="ruby-keyword">unless</span> ( <span class="ruby-ivar">@exclude_zero_rows</span> )
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@users</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">user</span> <span class="ruby-operator">|</span>
      <span class="ruby-identifier">user_total_for_row</span> = <span class="ruby-identifier">row</span>.<span class="ruby-identifier">user_total</span>( <span class="ruby-identifier">user</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> )
      <span class="ruby-keyword">yield</span>( <span class="ruby-identifier">user</span>, <span class="ruby-identifier">user_total_for_row</span> ) <span class="ruby-keyword">unless</span> ( <span class="ruby-ivar">@exclude_zero_rows</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">user_total_for_row</span>.<span class="ruby-identifier">nil?</span> )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- each_user_on_row-source -->
          
        </div>

        

        
      </div><!-- each_user_on_row-method -->

    
      <div id="method-i-frequency-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">frequency=</span><span
            class="method-args">( freq )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Set the ‘<a
href="Report.html#attribute-i-frequency_data">#frequency_data</a>’ field
when ‘frequency’ is updated externally.</p>
          

          
          <div class="method-source-code" id="frequency-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 629</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">frequency=</span>( <span class="ruby-identifier">freq</span> )
  <span class="ruby-ivar">@frequency</span>      = <span class="ruby-identifier">freq</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-ivar">@frequency_data</span> = <span class="ruby-constant">FREQUENCY</span>[ <span class="ruby-ivar">@frequency</span> ].<span class="ruby-identifier">dup</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- frequency-3D-source -->
          
        </div>

        

        
      </div><!-- frequency-3D-method -->

    
      <div id="method-i-has_rows-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">has_rows?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Returns ‘true’ if the report has any non-zero hours counted for any of its
rows, else ‘false’ (all tasks counted to zero hours within the other report
constraints/parameters).</p>
          

          
          <div class="method-source-code" id="has_rows-3F-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 696</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">has_rows?</span>
  <span class="ruby-keyword">not</span> <span class="ruby-ivar">@rows</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- has_rows-3F-source -->
          
        </div>

        

        
      </div><!-- has_rows-3F-method -->

    
      <div id="method-i-inactive_task_ids-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inactive_task_ids=</span><span
            class="method-args">( ids )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Build the ‘tasks’ array if ‘<a
href="Report.html#attribute-i-inactive_task_ids">#inactive_task_ids</a>’ is
updated externally. The result will be the sum of existing active and
updated inactive task IDs.</p>
          

          
          <div class="method-source-code" id="inactive_task_ids-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 603</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inactive_task_ids=</span>( <span class="ruby-identifier">ids</span> )
  <span class="ruby-ivar">@provided_inactive_task_ids</span> = <span class="ruby-identifier">map_raw_ids</span>( <span class="ruby-identifier">ids</span> )
  <span class="ruby-identifier">assign_actual_tasks_from_provided_ids</span>()
<span class="ruby-keyword">end</span></pre>
          </div><!-- inactive_task_ids-3D-source -->
          
        </div>

        

        
      </div><!-- inactive_task_ids-3D-method -->

    
      <div id="method-i-inactive_tasks" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inactive_tasks</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>As above, but for inactive tasks.</p>
          

          
          <div class="method-source-code" id="inactive_tasks-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 568</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inactive_tasks</span>
  <span class="ruby-ivar">@tasks</span>.<span class="ruby-identifier">where</span>( <span class="ruby-value">:active</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span> )
<span class="ruby-keyword">end</span></pre>
          </div><!-- inactive_tasks-source -->
          
        </div>

        

        
      </div><!-- inactive_tasks-method -->

    
      <div id="method-i-label" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">label</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Helper method which returns a user-displayable label describing this report
type. There’s a class method equivalent below.</p>
          

          
          <div class="method-source-code" id="label-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 886</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">label</span>
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@frequency_data</span>[ <span class="ruby-value">:label</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- label-source -->
          
        </div>

        

        
      </div><!-- label-method -->

    
      <div id="method-i-partial_column-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">partial_column?</span><span
            class="method-args">( range )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Does the column at the given index only contain partial results, because it
is the first or last column in the overall range and that range starts or
ends somewhere in the middle? Returns ‘true’ if so, else ‘false’.</p>
          

          
          <div class="method-source-code" id="partial_column-3F-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 934</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">partial_column?</span>( <span class="ruby-identifier">range</span> )
  <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">range</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@column_ranges</span>.<span class="ruby-identifier">first</span> )
    <span class="ruby-ivar">@column_first_partial</span>
  <span class="ruby-keyword">elsif</span> ( <span class="ruby-identifier">range</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@column_ranges</span>.<span class="ruby-identifier">last</span> )
    <span class="ruby-ivar">@column_last_partial</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- partial_column-3F-source -->
          
        </div>

        

        
      </div><!-- partial_column-3F-method -->

    
      <div id="method-i-range_end-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_end=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="range_end-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 638</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_end=</span>( <span class="ruby-identifier">value</span> );         <span class="ruby-ivar">@range_end</span>         = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_end-3D-source -->
          
        </div>

        

        
      </div><!-- range_end-3D-method -->

    
      <div id="method-i-range_month_end-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_month_end=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="range_month_end-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 643</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_month_end=</span>( <span class="ruby-identifier">value</span> );   <span class="ruby-ivar">@range_month_end</span>   = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_month_end-3D-source -->
          
        </div>

        

        
      </div><!-- range_month_end-3D-method -->

    
      <div id="method-i-range_month_start-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_month_start=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="range_month_start-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 642</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_month_start=</span>( <span class="ruby-identifier">value</span> ); <span class="ruby-ivar">@range_month_start</span> = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_month_start-3D-source -->
          
        </div>

        

        
      </div><!-- range_month_start-3D-method -->

    
      <div id="method-i-range_one_month-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_one_month=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="range_one_month-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 644</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_one_month=</span>( <span class="ruby-identifier">value</span> );   <span class="ruby-ivar">@range_one_month</span>   = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_one_month-3D-source -->
          
        </div>

        

        
      </div><!-- range_one_month-3D-method -->

    
      <div id="method-i-range_one_week-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_one_week=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="range_one_week-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 641</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_one_week=</span>( <span class="ruby-identifier">value</span> );    <span class="ruby-ivar">@range_one_week</span>    = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_one_week-3D-source -->
          
        </div>

        

        
      </div><!-- range_one_week-3D-method -->

    
      <div id="method-i-range_start-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_start=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Rationalise overall date ranges whenever a related field is updated
externally.</p>
          

          
          <div class="method-source-code" id="range_start-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 637</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_start=</span>( <span class="ruby-identifier">value</span> );       <span class="ruby-ivar">@range_start</span>       = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_start-3D-source -->
          
        </div>

        

        
      </div><!-- range_start-3D-method -->

    
      <div id="method-i-range_week_end-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_week_end=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="range_week_end-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 640</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_week_end=</span>( <span class="ruby-identifier">value</span> );    <span class="ruby-ivar">@range_week_end</span>    = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_week_end-3D-source -->
          
        </div>

        

        
      </div><!-- range_week_end-3D-method -->

    
      <div id="method-i-range_week_start-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">range_week_start=</span><span
            class="method-args">( value )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="range_week_start-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 639</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">range_week_start=</span>( <span class="ruby-identifier">value</span> );  <span class="ruby-ivar">@range_week_start</span>  = <span class="ruby-identifier">value</span>; <span class="ruby-identifier">rationalise_dates</span>(); <span class="ruby-keyword">end</span></pre>
          </div><!-- range_week_start-3D-source -->
          
        </div>

        

        
      </div><!-- range_week_start-3D-method -->

    
      <div id="method-i-reportable_user_ids-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reportable_user_ids=</span><span
            class="method-args">( ids )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Build the ‘user’ array if ‘<a
href="Report.html#attribute-i-reportable_user_ids">#reportable_user_ids</a>’
is updated externally.</p>
          

          
          <div class="method-source-code" id="reportable_user_ids-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 610</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">reportable_user_ids=</span>( <span class="ruby-identifier">ids</span> )
  <span class="ruby-identifier">ids</span> <span class="ruby-operator">||=</span> []
  <span class="ruby-identifier">ids</span> = <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">values</span> <span class="ruby-keyword">if</span> ( <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">is_a?</span>( <span class="ruby-constant">Hash</span> ) <span class="ruby-keyword">or</span> <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">is_a?</span>( <span class="ruby-constant">HashWithIndifferentAccess</span> ) )
  <span class="ruby-ivar">@reportable_user_ids</span> = <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">to_i</span> }

  <span class="ruby-comment"># Security - if the current user is restricted they might try and hack</span>
  <span class="ruby-comment"># the form to view other user details.</span>

  <span class="ruby-keyword">if</span> ( <span class="ruby-ivar">@current_user</span>.<span class="ruby-identifier">restricted?</span> )
    <span class="ruby-ivar">@reportable_user_ids</span> = [ <span class="ruby-ivar">@current_user</span>.<span class="ruby-identifier">id</span> ] <span class="ruby-keyword">unless</span>( <span class="ruby-ivar">@reportable_user_ids</span>.<span class="ruby-identifier">empty?</span> )
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Turn the list of (now numeric) user IDs into user objects.</span>

  <span class="ruby-ivar">@users</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">where</span>( <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@reportable_user_ids</span> )
<span class="ruby-keyword">end</span></pre>
          </div><!-- reportable_user_ids-3D-source -->
          
        </div>

        

        
      </div><!-- reportable_user_ids-3D-method -->

    
      <div id="method-i-row" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">row</span><span
            class="method-args">( task_id_str )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Return the row defined for the given task ID, specified as a string.</p>

<p>Will return ‘nil’ if no such row exists. Only really useful if the report
has been compiled by calling “compile”.</p>
          

          
          <div class="method-source-code" id="row-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 651</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">row</span>( <span class="ruby-identifier">task_id_str</span> )
  <span class="ruby-ivar">@rows</span>[ <span class="ruby-identifier">task_id_str</span> ]
<span class="ruby-keyword">end</span></pre>
          </div><!-- row-source -->
          
        </div>

        

        
      </div><!-- row-method -->

    
      <div id="method-i-row-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">row!</span><span
            class="method-args">( task_id_str )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Return the row defined for the given task ID, specified as a string.</p>

<p>Will create an empty <a href="Row.html">Row</a> instance in passing if
necessary. Usually only useful during the process of report compilation
(see “compile”) but may have specialist external uses too.</p>
          

          
          <div class="method-source-code" id="row-21-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 661</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">row!</span>( <span class="ruby-identifier">task_id_str</span> )
  <span class="ruby-ivar">@rows</span>[ <span class="ruby-identifier">task_id_str</span> ] <span class="ruby-operator">||=</span> <span class="ruby-constant">Row</span>.<span class="ruby-identifier">new</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- row-21-source -->
          
        </div>

        

        
      </div><!-- row-21-method -->

    
      <div id="method-i-task_ids-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_ids=</span><span
            class="method-args">( ids )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Build the ‘tasks’ array if ‘<a
href="Report.html#attribute-i-task_ids">#task_ids</a>’ is updated
externally.</p>
          

          
          <div class="method-source-code" id="task_ids-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 587</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_ids=</span>( <span class="ruby-identifier">ids</span> )
  <span class="ruby-ivar">@provided_task_ids</span> = <span class="ruby-identifier">map_raw_ids</span>( <span class="ruby-identifier">ids</span> )
  <span class="ruby-identifier">assign_actual_tasks_from_provided_ids</span>()
<span class="ruby-keyword">end</span></pre>
          </div><!-- task_ids-3D-source -->
          
        </div>

        

        
      </div><!-- task_ids-3D-method -->

    
      <div id="method-i-tasks-3D" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">tasks=</span><span
            class="method-args">( array )</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Set a task array directly (will always be filtered according to security
settings for the current user).</p>
          

          
          <div class="method-source-code" id="tasks-3D-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 575</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">tasks=</span>( <span class="ruby-identifier">array</span> )
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">array</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">array</span>.<span class="ruby-identifier">count</span>.<span class="ruby-identifier">zero?</span>
    <span class="ruby-ivar">@tasks</span> = <span class="ruby-constant">Task</span>.<span class="ruby-identifier">where</span>( <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">array</span> )
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@tasks</span> = <span class="ruby-constant">Task</span>.<span class="ruby-identifier">scoped</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">update_internal_task_lists</span>()
<span class="ruby-keyword">end</span></pre>
          </div><!-- tasks-3D-source -->
          
        </div>

        

        
      </div><!-- tasks-3D-method -->

    
      <div id="method-i-user_count" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">user_count</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Only useful for compiled reports - see “compile”.</p>

<p>Returns the number of users the report considered, taking into account zero
total users and the “hide zero columns” flag.</p>
          

          
          <div class="method-source-code" id="user_count-source">
            <pre><span class="ruby-comment"># File lib/track_record_report.rb, line 852</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">user_count</span>
  <span class="ruby-ivar">@filtered_users</span>.<span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- user_count-source -->
          
        </div>

        

        
      </div><!-- user_count-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.2.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

